

<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>会员注册_1元云购</title>
    <meta name="Description" content="" />
    <meta name="keywords" content="" />
    <link rel="stylesheet" type="text/css" href="css/newcss/sslComm.css" />
    <link rel="stylesheet" type="text/css" href="css/newcss/layout.css" />
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
     <script src="js/sweetalert.min.js"></script>  
	<link rel="stylesheet" href="css/newcss/sweetalert.css">
</head>
<body>
    <div class="wrapper">
        <input name="hidRegisterForward" type="hidden" id="hidRegisterForward" value="" />
        <div class="g-logo-top">
            <a href="" class="transparent-png fl">
                <img src="" alt="" />
            </a>
            <span class="fr">已有账号？<a id="hylinkLoginPage" class="blue" href="newlogin.html?">立即登录</a></span>
        </div>

        <div class="g-contentCon clrfix">

            <div class="m-main clrfix">
                <h2 class="gray3">新用户注册</h2>
                <div class="register-form-con clrfix">
                    <ul id="regist">
                        <li>
                        	
                            <input id="txtloginName" type="text" maxlength="100"/>
                            <b class="passport-icon user-name transparent-png"></b>
                            <em style="display: block;">手机号/邮箱地址</em>
                            <span class="orange" style="display: none;" id="NameTips"><i class="passport-icon transparent-png"></i>请输入正确的手机号或邮箱地址</span>
                            
                        </li>
                        <li>
                            <input id="txtPwd" type="password" maxlength="20"/>
                            <b class="passport-icon login-password transparent-png"></b>
                            <em style="display: block;">设置登录密码</em>
                            <span class="orange" style="display: none;"></span>      	
                            <span id="pwdStrength" style="display: none;"></span>

                        </li>
                        <li>
                            <input id="txtConPwd" type="password" maxlength="20"/>
                            <b class="passport-icon login-password transparent-png"></b>
                            <em style="display: block;">确认密码</em>
                            <span class="orange" style="display: none;"></span>
                        	<span id="pwdStrength" style="display: none;"></span>
                        </li>
                        
                    </ul>
                    <ul class="j-tips-wrap" id="j-tips-wrap"></ul>
                </div>
                <div class="link-con clrfix">
                    <a id="btnAgreeBtn" href="javascript:;" class="z-agreeBtn">注册</a>
                </div>
            </div>
        </div>

       <!-- 底部版权 -->
        <div class="g-copyrightCon clrfix">
           <div class="g-links">
               <a target="_blank" href="#" title="首页">首页</a><s></s>
               <a target="_blank" href="#" title="关于云购">关于云购</a><s></s>
               <a target="_blank" href="#" title="关于网站">关于网站</a><s></s>
           </div>
           <div class="g-copyright">
               Copyright &copy; 2017, 徐国伟的毕设(╯‵□′)╯︵┻━┻
           </div>
       </div>
</body>

 	   <script> 
 	   		$(function(){
 	   			//文本框获取焦点将文本清除
 	   			$("#regist li").click(function(){
 	   				$(this).find("em").css('display','none');
 	   				$(this).find("span").css('display','none');
 	   			})
 	   			
 	   			$("#txtloginName").blur(function(){
 	   				var registName = $("#txtloginName").val();
           			var registType = checktxt(registName);  //判断用户注册为手机注册1、邮箱注册2
           			//前端检查注册用户名
           			if(!registType){
           				$("#NameTips").css('display','block');
           				return;
           			}else{
           			//后台检查注册邮箱或手机是否已经被注册
           			var param={
           				registName : registName,
           				registType : registType
           			}
           			$.ajax({
           			type:"POST",
           			url:"./loginnamechk.action",
           			data:param,
           			dataType:"json",
           			success:function(json){
           				alert("用户名校验结束");
           			},
           			error:function(json){
           				alert("json="+json);
           				return false;
           			}
           			});   
           			}
           			
           		})
 	   		})
           $("#btnAgreeBtn").click(function(){
           		var loginName = $("#txtloginName").val();  //用户登录名，可以为手机号码或者邮箱
           		var Password = $("#txtPwd").val();
           		var conpassword = $("#txtConPwd").val();
           
           /*注册需满足的条件*/
           		
           		if(Password!=conpassword){
           			sweetAlert("请确认两次密码输入一致！");
           			return;
           		}
           		
           		var param = {
           			username : userName,
           			userpassword :Password
           		};
           		
           		sweetAlert("post start");
           		$.ajax({
           			type:"POST",
           			url:"./userregist.action",
           			data:param,
           			dataType:"json",
           			success:function(json){
           				if(json.output.flag){
           				swal({
						title: "注册成功！", 
						text: "是否前去登录？", 
						type: "success", 
						showCancelButton: true,
						closeOnConfirm: false,
						confirmButtonText: "登录",
						confirmButtonColor: "#f60"
					}, function() {
						window.location.href="./newlogin.html";
					});
						}else{
					swal("注册失败!", "请稍后再试！", "error");
					}
           			},
           			error:function(json){
           				alert("json="+json);
           				return false;
           			}
           		});           		
           })
           function checktxt(registName){
           	var flag = 0;
    			if((/^1(3|4|5|7|8)\d{9}$/.test(registName))){ 
        			flag = 1;  //表示注册用的是手机
        			return flag;
    			}
    			if((/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/.test(registName))){
    				flag = 2;	//表示注册用的是邮箱
    				return flag;
    			}
    		return flag;
           }
           
       </script> 
</html>
